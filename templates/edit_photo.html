<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edit Photo</title>-->
<!--    <style>-->
<!--        .canvas-container {-->
<!--            position: relative;-->
<!--            display: inline-block;-->
<!--        }-->

<!--        canvas {-->
<!--            border: 1px solid #ccc;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .sticker-btn {-->
<!--            border: none;-->
<!--            background: none;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        #save-btn {-->
<!--            margin-top: 20px;-->
<!--        }-->

<!--        .text-input {-->
<!--            width: 100px;-->
<!--            resize: both;-->
<!--            overflow: auto;-->
<!--            display: block;-->
<!--            padding: 5px;-->
<!--            border: 1px solid #ccc;-->
<!--            margin-top: 10px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--    <h1>Edytuj zdjęcie</h1>-->

<!--    <div class="controls">-->
<!--        &lt;!&ndash; Przyciski dodawania naklejek &ndash;&gt;-->
<!--        <h3>Dodaj naklejki:</h3>-->
<!--        {% for sticker in stickers %}-->
<!--            <button class="sticker-btn" onclick="addSticker('{{ sticker.image.url }}')">-->
<!--                <img src="{{ sticker.image.url }}" alt="Naklejka" width="50" height="50">-->
<!--            </button>-->
<!--        {% endfor %}-->
<!--    </div>-->

<!--    <div class="controls">-->
<!--        &lt;!&ndash; Przycisk dodawania tekstu &ndash;&gt;-->
<!--        <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--        <button onclick="addText()">Dodaj tekst</button>-->
<!--    </div>-->

<!--    &lt;!&ndash; Kontener dla canvas &ndash;&gt;-->
<!--    <div class="canvas-container">-->
<!--        <canvas id="canvas"></canvas>-->
<!--    </div>-->

<!--    &lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--    <form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--        {% csrf_token %}-->
<!--        <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--        <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--    </form>-->

<!--    <script>-->
<!--        let canvas = document.getElementById('canvas');-->
<!--        let context = canvas.getContext('2d');-->
<!--        let draggedElement = null;-->
<!--        let photo = new Image();-->
<!--        let elements = [];-->

<!--        // Ustawienie zdjęcia w tle canvas-->
<!--        photo.src = "{{ photo.image.url }}";-->
<!--        photo.onload = function() {-->
<!--            canvas.width = photo.width;-->
<!--            canvas.height = photo.height;-->
<!--            context.drawImage(photo, 0, 0);-->
<!--        };-->

<!--        // Funkcja dodająca naklejkę do canvas-->
<!--        function addSticker(stickerUrl) {-->
<!--            const sticker = new Image();-->
<!--            sticker.src = stickerUrl;-->
<!--            sticker.onload = function() {-->
<!--                elements.push({-->
<!--                    type: 'sticker',-->
<!--                    image: sticker,-->
<!--                    x: 10,-->
<!--                    y: 10,-->
<!--                    width: sticker.width / 2,-->
<!--                    height: sticker.height / 2-->
<!--                });-->
<!--                redrawCanvas();-->
<!--            };-->
<!--        }-->

<!--        // Funkcja dodająca tekst do canvas-->
<!--        function addText() {-->
<!--            const text = document.getElementById('text-to-add').value;-->
<!--            if (text.trim() !== '') {-->
<!--                elements.push({-->
<!--                    type: 'text',-->
<!--                    text: text,-->
<!--                    x: 10,-->
<!--                    y: 50,-->
<!--                    fontSize: 20,-->
<!--                    color: 'black'-->
<!--                });-->
<!--                redrawCanvas();-->
<!--            }-->
<!--        }-->

<!--        // Przerysowanie całego canvas-->
<!--        function redrawCanvas() {-->
<!--            context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--            context.drawImage(photo, 0, 0);-->

<!--            elements.forEach((element) => {-->
<!--                if (element.type === 'sticker') {-->
<!--                    context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--                } else if (element.type === 'text') {-->
<!--                    context.font = `${element.fontSize}px Arial`;-->
<!--                    context.fillStyle = element.color;-->
<!--                    context.fillText(element.text, element.x, element.y);-->
<!--                }-->
<!--            });-->
<!--        }-->

<!--        // Zdarzenia przeciągania-->
<!--        canvas.addEventListener('mousedown', function(e) {-->
<!--            const mouseX = e.offsetX;-->
<!--            const mouseY = e.offsetY;-->

<!--            draggedElement = elements.find((element) => {-->
<!--                if (element.type === 'sticker') {-->
<!--                    return mouseX > element.x && mouseX < element.x + element.width &&-->
<!--                           mouseY > element.y && mouseY < element.y + element.height;-->
<!--                } else if (element.type === 'text') {-->
<!--                    return mouseX > element.x && mouseX < element.x + context.measureText(element.text).width &&-->
<!--                           mouseY > element.y - element.fontSize && mouseY < element.y;-->
<!--                }-->
<!--                return false;-->
<!--            });-->
<!--        });-->

<!--        canvas.addEventListener('mousemove', function(e) {-->
<!--            if (draggedElement) {-->
<!--                const mouseX = e.offsetX;-->
<!--                const mouseY = e.offsetY;-->

<!--                draggedElement.x = mouseX;-->
<!--                draggedElement.y = mouseY;-->

<!--                redrawCanvas();-->
<!--            }-->
<!--        });-->

<!--        canvas.addEventListener('mouseup', function() {-->
<!--            draggedElement = null;-->
<!--        });-->

<!--        // Zapis zdjęcia z naklejkami i tekstem-->
<!--        document.querySelector('form').addEventListener('submit', function(event) {-->
<!--            event.preventDefault();-->

<!--            const editedPhotoData = document.getElementById('edited-photo-data');-->

<!--            // Rysowanie zdjęcia na canvas-->
<!--            context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--            context.drawImage(photo, 0, 0);-->

<!--            // Rysowanie elementów (naklejki, tekst) na canvas-->
<!--            elements.forEach((element) => {-->
<!--                if (element.type === 'sticker') {-->
<!--                    context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--                } else if (element.type === 'text') {-->
<!--                    context.font = `${element.fontSize}px Arial`;-->
<!--                    context.fillStyle = element.color;-->
<!--                    context.fillText(element.text, element.x, element.y);-->
<!--                }-->
<!--            });-->

<!--            // Ustawienie wygenerowanego zdjęcia do ukrytego inputa-->
<!--            editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--            // Wysłanie formularza-->
<!--            event.target.submit();-->
<!--        });-->
<!--    </script>-->
<!--</body>-->
<!--</html>-->




<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edycja zdjęcia</title>-->
<!--    <style>-->
<!--        .photo-container {-->
<!--            position: relative;-->
<!--            display: inline-block;-->
<!--        }-->

<!--        #photo {-->
<!--            max-width: 100%;-->
<!--            height: auto;-->
<!--        }-->

<!--        .sticker, .text-label {-->
<!--            position: absolute;-->
<!--            cursor: move;-->
<!--        }-->

<!--        .text-label {-->
<!--            font-size: 20px;-->
<!--            color: black;-->
<!--            background-color: transparent;-->
<!--            border: none;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--<h2>Edycja zdjęcia</h2>-->

<!--&lt;!&ndash; Formularz do dodawania naklejek &ndash;&gt;-->
<!--<div>-->
<!--    <label for="stickers">Dodaj naklejki:</label>-->
<!--    <br>-->
<!--    <button id="sticker-btn">-->
<!--        <img src="/path/to/your/sticker.png" alt="Naklejka" width="50px" height="50px" />-->
<!--    </button>-->
<!--</div>-->

<!--&lt;!&ndash; Pole do wprowadzania tekstu &ndash;&gt;-->
<!--<div>-->
<!--    <input type="text" id="input-text" placeholder="Wpisz tekst">-->
<!--    <button id="add-text-btn">Dodaj tekst</button>-->
<!--</div>-->

<!--&lt;!&ndash; Kontener na zdjęcie i naklejki/tekst &ndash;&gt;-->
<!--<div class="photo-container">-->
<!--    <img id="photo" src="/path/to/photo.png" alt="Zdjęcie do edycji">-->
<!--</div>-->

<!--&lt;!&ndash; Przycisk zapisu &ndash;&gt;-->
<!--<form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--    {% csrf_token %}-->
<!--    <input type="hidden" name="edited-image" id="edited-image">-->
<!--    <button type="submit">Zapisz zdjęcie</button>-->
<!--</form>-->

<!--<script>-->
<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        const photoContainer = document.querySelector('.photo-container');-->
<!--        const photo = document.getElementById('photo');-->
<!--        const stickerBtn = document.getElementById('sticker-btn');-->
<!--        const addTextBtn = document.getElementById('add-text-btn');-->
<!--        const inputText = document.getElementById('input-text');-->
<!--        const editedImageInput = document.getElementById('edited-image');-->

<!--        // Funkcja dodająca naklejkę na zdjęcie-->
<!--        stickerBtn.addEventListener('click', function(e) {-->
<!--            e.preventDefault();-->
<!--            const img = document.createElement('img');-->
<!--            img.src = '/path/to/your/sticker.png';-->
<!--            img.className = 'sticker';-->
<!--            img.style.top = '10px';-->
<!--            img.style.left = '10px';-->
<!--            img.style.width = '100px';  // Możesz dostosować rozmiar naklejki-->
<!--            img.draggable = true;-->
<!--            enableDrag(img);-->
<!--            photoContainer.appendChild(img);-->
<!--        });-->

<!--        // Funkcja dodająca tekst na zdjęcie-->
<!--        addTextBtn.addEventListener('click', function() {-->
<!--            const text = inputText.value;-->
<!--            if (text.trim() === '') return;-->
<!--            const textLabel = document.createElement('div');-->
<!--            textLabel.className = 'text-label';-->
<!--            textLabel.contentEditable = true;-->
<!--            textLabel.innerText = text;-->
<!--            textLabel.style.top = '10px';-->
<!--            textLabel.style.left = '10px';-->
<!--            enableDrag(textLabel);-->
<!--            photoContainer.appendChild(textLabel);-->
<!--            inputText.value = '';  // Reset pola tekstowego-->
<!--        });-->

<!--        // Funkcja umożliwiająca przeciąganie elementów (naklejki, tekstu)-->
<!--        function enableDrag(element) {-->
<!--            element.addEventListener('mousedown', function(e) {-->
<!--                let offsetX = e.clientX - element.getBoundingClientRect().left;-->
<!--                let offsetY = e.clientY - element.getBoundingClientRect().top;-->

<!--                function mouseMoveHandler(e) {-->
<!--                    element.style.left = `${e.clientX - offsetX}px`;-->
<!--                    element.style.top = `${e.clientY - offsetY}px`;-->
<!--                }-->

<!--                function mouseUpHandler() {-->
<!--                    document.removeEventListener('mousemove', mouseMoveHandler);-->
<!--                    document.removeEventListener('mouseup', mouseUpHandler);-->
<!--                }-->

<!--                document.addEventListener('mousemove', mouseMoveHandler);-->
<!--                document.addEventListener('mouseup', mouseUpHandler);-->
<!--            });-->
<!--        }-->

<!--        // Funkcja do zapisu edytowanego zdjęcia-->
<!--        document.querySelector('form').addEventListener('submit', function(e) {-->
<!--            e.preventDefault();-->

<!--            // Tworzenie nowego canvasa, który połączy zdjęcie z naklejkami i tekstem-->
<!--            const canvas = document.createElement('canvas');-->
<!--            canvas.width = photo.width;-->
<!--            canvas.height = photo.height;-->
<!--            const ctx = canvas.getContext('2d');-->

<!--            // Rysowanie zdjęcia na canvasie-->
<!--            ctx.drawImage(photo, 0, 0, canvas.width, canvas.height);-->

<!--            // Rysowanie wszystkich naklejek-->
<!--            document.querySelectorAll('.sticker').forEach(function(sticker) {-->
<!--                const { top, left, width, height } = sticker.getBoundingClientRect();-->
<!--                const photoRect = photo.getBoundingClientRect();-->
<!--                ctx.drawImage(sticker, left - photoRect.left, top - photoRect.top, width, height);-->
<!--            });-->

<!--            // Rysowanie wszystkich tekstów-->
<!--            document.querySelectorAll('.text-label').forEach(function(textLabel) {-->
<!--                const { top, left } = textLabel.getBoundingClientRect();-->
<!--                const photoRect = photo.getBoundingClientRect();-->
<!--                ctx.font = '20px Arial';-->
<!--                ctx.fillStyle = 'black';  // Kolor tekstu-->
<!--                ctx.fillText(textLabel.innerText, left - photoRect.left, top - photoRect.top + 20);-->
<!--            });-->

<!--            // Przekazanie danych do ukrytego inputa-->
<!--            const dataUrl = canvas.toDataURL('image/png');-->
<!--            editedImageInput.value = dataUrl;-->

<!--            // Teraz wyślij formularz-->
<!--            e.target.submit();-->
<!--        });-->
<!--    });-->
<!--</script>-->

<!--</body>-->
<!--</html>-->



<!--{% load static %}-->
<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edycja zdjęcia</title>-->
<!--    <style>-->
<!--        .photo-container {-->
<!--            position: relative;-->
<!--            display: inline-block;-->
<!--        }-->

<!--        #photo {-->
<!--            max-width: 100%;-->
<!--            height: auto;-->
<!--        }-->

<!--        .sticker, .text-label {-->
<!--            position: absolute;-->
<!--            cursor: move;-->
<!--        }-->

<!--        .text-label {-->
<!--            font-size: 20px;-->
<!--            color: black;-->
<!--            background-color: transparent;-->
<!--            border: none;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--<h2>Edycja zdjęcia</h2>-->

<!--&lt;!&ndash; Formularz do dodawania naklejek &ndash;&gt;-->
<!--<div>-->
<!--    <label for="stickers">Dodaj naklejki:</label>-->
<!--    <br>-->
<!--    <button id="sticker-btn">-->
<!--        <img src="{% static 'sticker.png' %}" alt="Naklejka" width="50px" height="50px" />-->
<!--    </button>-->
<!--</div>-->

<!--&lt;!&ndash; Pole do wprowadzania tekstu &ndash;&gt;-->
<!--<div>-->
<!--    <input type="text" id="input-text" placeholder="Wpisz tekst">-->
<!--    <button id="add-text-btn">Dodaj tekst</button>-->
<!--</div>-->

<!--&lt;!&ndash; Kontener na zdjęcie i naklejki/tekst &ndash;&gt;-->
<!--<div class="photo-container">-->
<!--    <img id="photo" src="{% static 'path/to/your/photo.png' %}" alt="Zdjęcie do edycji">-->
<!--</div>-->

<!--&lt;!&ndash; Przycisk zapisu &ndash;&gt;-->
<!--<form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--    {% csrf_token %}-->
<!--    <input type="hidden" name="edited-image" id="edited-image">-->
<!--    <button type="submit">Zapisz zdjęcie</button>-->
<!--</form>-->

<!--<script>-->
<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        const photoContainer = document.querySelector('.photo-container');-->
<!--        const photo = document.getElementById('photo');-->
<!--        const stickerBtn = document.getElementById('sticker-btn');-->
<!--        const addTextBtn = document.getElementById('add-text-btn');-->
<!--        const inputText = document.getElementById('input-text');-->
<!--        const editedImageInput = document.getElementById('edited-image');-->

<!--        // Funkcja dodająca naklejkę na zdjęcie-->
<!--        stickerBtn.addEventListener('click', function(e) {-->
<!--            e.preventDefault();-->
<!--            const img = document.createElement('img');-->
<!--            img.src = '{% static 'path/to/your/sticker.png' %}';-->
<!--            img.className = 'sticker';-->
<!--            img.style.top = '10px';-->
<!--            img.style.left = '10px';-->
<!--            img.style.width = '100px';  // Możesz dostosować rozmiar naklejki-->
<!--            img.draggable = true;-->
<!--            enableDrag(img);-->
<!--            photoContainer.appendChild(img);-->
<!--        });-->

<!--        // Funkcja dodająca tekst na zdjęcie-->
<!--        addTextBtn.addEventListener('click', function() {-->
<!--            const text = inputText.value;-->
<!--            if (text.trim() === '') return;-->
<!--            const textLabel = document.createElement('div');-->
<!--            textLabel.className = 'text-label';-->
<!--            textLabel.contentEditable = true;-->
<!--            textLabel.innerText = text;-->
<!--            textLabel.style.top = '10px';-->
<!--            textLabel.style.left = '10px';-->
<!--            enableDrag(textLabel);-->
<!--            photoContainer.appendChild(textLabel);-->
<!--            inputText.value = '';  // Reset pola tekstowego-->
<!--        });-->

<!--        // Funkcja umożliwiająca przeciąganie elementów (naklejki, tekstu)-->
<!--        function enableDrag(element) {-->
<!--            element.addEventListener('mousedown', function(e) {-->
<!--                let offsetX = e.clientX - element.getBoundingClientRect().left;-->
<!--                let offsetY = e.clientY - element.getBoundingClientRect().top;-->

<!--                function mouseMoveHandler(e) {-->
<!--                    element.style.left = `${e.clientX - offsetX}px`;-->
<!--                    element.style.top = `${e.clientY - offsetY}px`;-->
<!--                }-->

<!--                function mouseUpHandler() {-->
<!--                    document.removeEventListener('mousemove', mouseMoveHandler);-->
<!--                    document.removeEventListener('mouseup', mouseUpHandler);-->
<!--                }-->

<!--                document.addEventListener('mousemove', mouseMoveHandler);-->
<!--                document.addEventListener('mouseup', mouseUpHandler);-->
<!--            });-->
<!--        }-->

<!--        // Funkcja do zapisu edytowanego zdjęcia-->
<!--        document.querySelector('form').addEventListener('submit', function(e) {-->
<!--            e.preventDefault();-->

<!--            // Tworzenie nowego canvasa, który połączy zdjęcie z naklejkami i tekstem-->
<!--            const canvas = document.createElement('canvas');-->
<!--            canvas.width = photo.width;-->
<!--            canvas.height = photo.height;-->
<!--            const ctx = canvas.getContext('2d');-->

<!--            // Rysowanie zdjęcia na canvasie-->
<!--            ctx.drawImage(photo, 0, 0, canvas.width, canvas.height);-->

<!--            // Rysowanie wszystkich naklejek-->
<!--            document.querySelectorAll('.sticker').forEach(function(sticker) {-->
<!--                const { top, left, width, height } = sticker.getBoundingClientRect();-->
<!--                const photoRect = photo.getBoundingClientRect();-->
<!--                ctx.drawImage(sticker, left - photoRect.left, top - photoRect.top, width, height);-->
<!--            });-->

<!--            // Rysowanie wszystkich tekstów-->
<!--            document.querySelectorAll('.text-label').forEach(function(textLabel) {-->
<!--                const { top, left } = textLabel.getBoundingClientRect();-->
<!--                const photoRect = photo.getBoundingClientRect();-->
<!--                ctx.font = '20px Arial';-->
<!--                ctx.fillStyle = 'black';  // Kolor tekstu-->
<!--                ctx.fillText(textLabel.innerText, left - photoRect.left, top - photoRect.top + 20);-->
<!--            });-->

<!--            // Przekazanie danych do ukrytego inputa-->
<!--            const dataUrl = canvas.toDataURL('image/png');-->
<!--            editedImageInput.value = dataUrl;-->

<!--            // Teraz wyślij formularz-->
<!--            e.target.submit();-->
<!--        });-->
<!--    });-->
<!--</script>-->

<!--</body>-->
<!--</html>-->



<!--{% load static %}-->
<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edycja zdjęcia</title>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        canvas {-->
<!--            border: 1px solid black;-->
<!--        }-->

<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->

<!--        .sticker-btn img {-->
<!--            cursor: pointer;-->
<!--            width: 50px;-->
<!--            height: 50px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--<h1>Edytuj zdjęcie</h1>-->

<!--<div class="controls">-->
<!--    &lt;!&ndash; Przyciski dodawania naklejek &ndash;&gt;-->
<!--    <h3>Dodaj naklejki:</h3>-->
<!--    {% for sticker in stickers %}-->
<!--        <button class="sticker-btn" onclick="addSticker('{{ sticker.image.url }}')">-->
<!--            <img src="{{ sticker.image.url }}" alt="Naklejka" width="50" height="50">-->
<!--        </button>-->
<!--    {% endfor %}-->
<!--</div>-->

<!--<div class="controls">-->
<!--    &lt;!&ndash; Przycisk dodawania tekstu &ndash;&gt;-->
<!--    <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--    <button onclick="addText()">Dodaj tekst</button>-->
<!--</div>-->

<!--&lt;!&ndash; Kontener dla canvas &ndash;&gt;-->
<!--<div class="canvas-container">-->
<!--    <canvas id="canvas"></canvas>-->
<!--</div>-->

<!--&lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--<form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--    {% csrf_token %}-->
<!--    <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--    <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--</form>-->

<!--<script>-->
<!--    let canvas = document.getElementById('canvas');-->
<!--    let context = canvas.getContext('2d');-->
<!--    let draggedElement = null;-->
<!--    let photo = new Image();-->
<!--    let elements = [];-->

<!--    // Ustawienie zdjęcia w tle canvas-->
<!--    photo.src = "{{ photo.image.url }}";-->
<!--    photo.onload = function() {-->
<!--        canvas.width = photo.width;-->
<!--        canvas.height = photo.height;-->
<!--        context.drawImage(photo, 0, 0);-->
<!--    };-->

<!--    // Funkcja dodająca naklejkę do canvas-->
<!--    function addSticker(stickerUrl) {-->
<!--        const sticker = new Image();-->
<!--        sticker.src = stickerUrl;-->
<!--        sticker.onload = function() {-->
<!--            elements.push({-->
<!--                type: 'sticker',-->
<!--                image: sticker,-->
<!--                x: 10,-->
<!--                y: 10,-->
<!--                width: sticker.width / 2,-->
<!--                height: sticker.height / 2-->
<!--            });-->
<!--            redrawCanvas();-->
<!--        };-->
<!--    }-->

<!--    // Funkcja dodająca tekst do canvas-->
<!--    function addText() {-->
<!--        const text = document.getElementById('text-to-add').value;-->
<!--        if (text.trim() !== '') {-->
<!--            elements.push({-->
<!--                type: 'text',-->
<!--                text: text,-->
<!--                x: 10,-->
<!--                y: 50,-->
<!--                fontSize: 20,-->
<!--                color: 'black'-->
<!--            });-->
<!--            redrawCanvas();-->
<!--        }-->
<!--    }-->

<!--    // Przerysowanie całego canvas-->
<!--    function redrawCanvas() {-->
<!--        context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--        context.drawImage(photo, 0, 0);-->

<!--        elements.forEach((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--            } else if (element.type === 'text') {-->
<!--                context.font = `${element.fontSize}px Arial`;-->
<!--                context.fillStyle = element.color;-->
<!--                context.fillText(element.text, element.x, element.y);-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // Zdarzenia przeciągania-->
<!--    canvas.addEventListener('mousedown', function(e) {-->
<!--        const mouseX = e.offsetX;-->
<!--        const mouseY = e.offsetY;-->

<!--        draggedElement = elements.find((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                return mouseX > element.x && mouseX < element.x + element.width &&-->
<!--                       mouseY > element.y && mouseY < element.y + element.height;-->
<!--            } else if (element.type === 'text') {-->
<!--                return mouseX > element.x && mouseX < element.x + context.measureText(element.text).width &&-->
<!--                       mouseY > element.y - element.fontSize && mouseY < element.y;-->
<!--            }-->
<!--            return false;-->
<!--        });-->
<!--    });-->

<!--    canvas.addEventListener('mousemove', function(e) {-->
<!--        if (draggedElement) {-->
<!--            const mouseX = e.offsetX;-->
<!--            const mouseY = e.offsetY;-->

<!--            draggedElement.x = mouseX;-->
<!--            draggedElement.y = mouseY;-->

<!--            redrawCanvas();-->
<!--        }-->
<!--    });-->

<!--    canvas.addEventListener('mouseup', function() {-->
<!--        draggedElement = null;-->
<!--    });-->

<!--    // Zapis zdjęcia z naklejkami i tekstem-->
<!--    document.querySelector('form').addEventListener('submit', function(event) {-->
<!--        event.preventDefault();-->

<!--        const editedPhotoData = document.getElementById('edited-photo-data');-->

<!--        // Rysowanie zdjęcia na canvas-->
<!--        context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--        context.drawImage(photo, 0, 0);-->

<!--        // Rysowanie elementów (naklejki, tekst) na canvas-->
<!--        elements.forEach((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--            } else if (element.type === 'text') {-->
<!--                context.font = `${element.fontSize}px Arial`;-->
<!--                context.fillStyle = element.color;-->
<!--                context.fillText(element.text, element.x, element.y);-->
<!--            }-->
<!--        });-->

<!--        // Ustawienie wygenerowanego zdjęcia do ukrytego inputa-->
<!--        editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--        // Wysłanie formularza-->
<!--        event.target.submit();-->
<!--    });-->
<!--</script>-->

<!--</body>-->
<!--</html>-->




<!--{% load static %}-->
<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edycja zdjęcia</title>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        canvas {-->
<!--            border: 1px solid black;-->
<!--        }-->

<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->

<!--        .sticker-btn img {-->
<!--            cursor: pointer;-->
<!--            width: 50px;-->
<!--            height: 50px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--<h1>Edytuj zdjęcie</h1>-->

<!--<div class="controls">-->
<!--    &lt;!&ndash; Przyciski dodawania naklejek &ndash;&gt;-->
<!--    <h3>Dodaj naklejki:</h3>-->
<!--    {% for sticker in stickers %}-->
<!--        <button class="sticker-btn" onclick="addSticker('{{ sticker.image.url }}')">-->
<!--            <img src="{{ sticker.image.url }}" alt="Naklejka" width="50" height="50">-->
<!--        </button>-->
<!--    {% endfor %}-->
<!--</div>-->

<!--<div class="controls">-->
<!--    &lt;!&ndash; Przycisk dodawania tekstu &ndash;&gt;-->
<!--    <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--    <button onclick="addText()">Dodaj tekst</button>-->
<!--</div>-->

<!--&lt;!&ndash; Kontener dla canvas &ndash;&gt;-->
<!--<div class="canvas-container">-->
<!--    <canvas id="canvas"></canvas>-->
<!--</div>-->

<!--&lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--<form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--    {% csrf_token %}-->
<!--    <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--    <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--</form>-->

<!--<script>-->
<!--    let canvas = document.getElementById('canvas');-->
<!--    let context = canvas.getContext('2d');-->
<!--    let draggedElement = null;-->
<!--    let photo = new Image();-->
<!--    let elements = [];-->

<!--    // Ustawienie zdjęcia w tle canvas-->
<!--    photo.src = "{{ photo.image.url }}";-->
<!--    photo.onload = function() {-->
<!--        canvas.width = photo.width;-->
<!--        canvas.height = photo.height;-->
<!--        context.drawImage(photo, 0, 0);-->
<!--    };-->

<!--    // Funkcja dodająca naklejkę do canvas-->
<!--    function addSticker(stickerUrl) {-->
<!--        const sticker = new Image();-->
<!--        sticker.src = stickerUrl;-->
<!--        sticker.onload = function() {-->
<!--            elements.push({-->
<!--                type: 'sticker',-->
<!--                image: sticker,-->
<!--                x: 10,  // Początkowa pozycja naklejki-->
<!--                y: 10,-->
<!--                width: sticker.width / 2,  // Zmniejszenie rozmiaru naklejki-->
<!--                height: sticker.height / 2-->
<!--            });-->
<!--            redrawCanvas();-->
<!--        };-->
<!--    }-->

<!--    // Funkcja dodająca tekst do canvas-->
<!--    function addText() {-->
<!--        const text = document.getElementById('text-to-add').value;-->
<!--        if (text.trim() !== '') {-->
<!--            elements.push({-->
<!--                type: 'text',-->
<!--                text: text,-->
<!--                x: 10,  // Początkowa pozycja tekstu-->
<!--                y: 50,-->
<!--                fontSize: 20,-->
<!--                color: 'black'-->
<!--            });-->
<!--            redrawCanvas();-->
<!--        }-->
<!--    }-->

<!--    // Przerysowanie całego canvas-->
<!--    function redrawCanvas() {-->
<!--        // Czyszczenie canvasu-->
<!--        context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--        context.drawImage(photo, 0, 0);-->

<!--        // Rysowanie elementów (naklejek i tekstu)-->
<!--        elements.forEach((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--            } else if (element.type === 'text') {-->
<!--                context.font = `${element.fontSize}px Arial`;-->
<!--                context.fillStyle = element.color;-->
<!--                context.fillText(element.text, element.x, element.y);-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // Zdarzenia przeciągania-->
<!--    canvas.addEventListener('mousedown', function(e) {-->
<!--        const mouseX = e.offsetX;-->
<!--        const mouseY = e.offsetY;-->

<!--        draggedElement = elements.find((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                return mouseX > element.x && mouseX < element.x + element.width &&-->
<!--                       mouseY > element.y && mouseY < element.y + element.height;-->
<!--            } else if (element.type === 'text') {-->
<!--                return mouseX > element.x && mouseX < element.x + context.measureText(element.text).width &&-->
<!--                       mouseY > element.y - element.fontSize && mouseY < element.y;-->
<!--            }-->
<!--            return false;-->
<!--        });-->
<!--    });-->

<!--    canvas.addEventListener('mousemove', function(e) {-->
<!--        if (draggedElement) {-->
<!--            const mouseX = e.offsetX;-->
<!--            const mouseY = e.offsetY;-->

<!--            draggedElement.x = mouseX;-->
<!--            draggedElement.y = mouseY;-->

<!--            redrawCanvas();-->
<!--        }-->
<!--    });-->

<!--    canvas.addEventListener('mouseup', function() {-->
<!--        draggedElement = null;-->
<!--    });-->

<!--    // Zapis zdjęcia z naklejkami i tekstem-->
<!--    document.querySelector('form').addEventListener('submit', function(event) {-->
<!--        event.preventDefault();-->

<!--        const editedPhotoData = document.getElementById('edited-photo-data');-->

<!--        // Rysowanie zdjęcia na canvas-->
<!--        context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--        context.drawImage(photo, 0, 0);-->

<!--        // Rysowanie elementów (naklejki, tekst) na canvas-->
<!--        elements.forEach((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--            } else if (element.type === 'text') {-->
<!--                context.font = `${element.fontSize}px Arial`;-->
<!--                context.fillStyle = element.color;-->
<!--                context.fillText(element.text, element.x, element.y);-->
<!--            }-->
<!--        });-->

<!--        // Ustawienie wygenerowanego zdjęcia do ukrytego inputa-->
<!--        editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--        // Wysłanie formularza-->
<!--        event.target.submit();-->
<!--    });-->
<!--</script>-->

<!--</body>-->
<!--</html>-->



<!--{% load static %}-->
<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edycja zdjęcia</title>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        canvas {-->
<!--            border: 1px solid black;-->
<!--        }-->

<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->

<!--        .sticker-btn img {-->
<!--            cursor: pointer;-->
<!--            width: 50px;-->
<!--            height: 50px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--<h1>Edytuj zdjęcie</h1>-->

<!--<div class="controls">-->
<!--    &lt;!&ndash; Wyświetl naklejki jako przyciski &ndash;&gt;-->
<!--    <h3>Dodaj naklejki:</h3>-->
<!--    {% for sticker in stickers %}-->
<!--        <button class="sticker-btn" onclick="addSticker('{% static 'media/stickers/' %}{{ sticker }}')">-->
<!--            <img src="{% static 'media/stickers/' %}{{ sticker }}" alt="Naklejka" width="50" height="50">-->
<!--        </button>-->
<!--    {% endfor %}-->
<!--</div>-->

<!--<div class="controls">-->
<!--    &lt;!&ndash; Przycisk dodawania tekstu &ndash;&gt;-->
<!--    <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--    <button onclick="addText()">Dodaj tekst</button>-->
<!--</div>-->

<!--&lt;!&ndash; Kontener dla canvas &ndash;&gt;-->
<!--<div class="canvas-container">-->
<!--    <canvas id="canvas"></canvas>-->
<!--</div>-->

<!--&lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--<form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--    {% csrf_token %}-->
<!--    <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--    <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--</form>-->

<!--<script>-->
<!--    let canvas = document.getElementById('canvas');-->
<!--    let context = canvas.getContext('2d');-->
<!--    let draggedElement = null;-->
<!--    let photo = new Image();-->
<!--    let elements = [];-->

<!--    // Ustawienie zdjęcia w tle canvas-->
<!--    photo.src = "{{ photo.image.url }}";-->
<!--    photo.onload = function() {-->
<!--        canvas.width = photo.width;-->
<!--        canvas.height = photo.height;-->
<!--        context.drawImage(photo, 0, 0);-->
<!--        redrawCanvas(); // Pierwsze rysowanie-->
<!--    };-->

<!--    // Funkcja dodająca naklejkę do canvas-->
<!--    function addSticker(stickerUrl) {-->
<!--        const sticker = new Image();-->
<!--        sticker.src = stickerUrl;-->

<!--        sticker.onload = function() {-->
<!--            // Sprawdzenie, czy obrazek został poprawnie załadowany-->
<!--            if (sticker.complete && sticker.naturalHeight !== 0) {-->
<!--                elements.push({-->
<!--                    type: 'sticker',-->
<!--                    image: sticker,-->
<!--                    x: 10,  // Początkowa pozycja naklejki-->
<!--                    y: 10,-->
<!--                    width: sticker.width / 2,  // Zmniejszenie rozmiaru naklejki-->
<!--                    height: sticker.height / 2-->
<!--                });-->
<!--                redrawCanvas(); // Aktualizacja canvas po dodaniu naklejki-->
<!--            } else {-->
<!--                console.error("Nie można załadować naklejki:", stickerUrl);-->
<!--            }-->
<!--        };-->

<!--        sticker.onerror = function() {-->
<!--            console.error("Błąd w ładowaniu naklejki:", stickerUrl);-->
<!--        };-->
<!--    }-->

<!--    // Funkcja dodająca tekst do canvas-->
<!--    function addText() {-->
<!--        const text = document.getElementById('text-to-add').value;-->
<!--        if (text.trim() !== '') {-->
<!--            elements.push({-->
<!--                type: 'text',-->
<!--                text: text,-->
<!--                x: 10,  // Początkowa pozycja tekstu-->
<!--                y: 50,-->
<!--                fontSize: 20,-->
<!--                color: 'black'-->
<!--            });-->
<!--            redrawCanvas();-->
<!--        }-->
<!--    }-->

<!--    // Przerysowanie całego canvas-->
<!--    function redrawCanvas() {-->
<!--        // Czyszczenie canvasu-->
<!--        context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--        context.drawImage(photo, 0, 0);-->

<!--        // Rysowanie elementów (naklejek i tekstu)-->
<!--        elements.forEach((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--            } else if (element.type === 'text') {-->
<!--                context.font = `${element.fontSize}px Arial`;-->
<!--                context.fillStyle = element.color;-->
<!--                context.fillText(element.text, element.x, element.y);-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // Zdarzenia przeciągania-->
<!--    canvas.addEventListener('mousedown', function(e) {-->
<!--        const mouseX = e.offsetX;-->
<!--        const mouseY = e.offsetY;-->

<!--        draggedElement = elements.find((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                return mouseX > element.x && mouseX < element.x + element.width &&-->
<!--                       mouseY > element.y && mouseY < element.y + element.height;-->
<!--            } else if (element.type === 'text') {-->
<!--                return mouseX > element.x && mouseX < element.x + context.measureText(element.text).width &&-->
<!--                       mouseY > element.y - element.fontSize && mouseY < element.y;-->
<!--            }-->
<!--            return false;-->
<!--        });-->
<!--    });-->

<!--    canvas.addEventListener('mousemove', function(e) {-->
<!--        if (draggedElement) {-->
<!--            const mouseX = e.offsetX;-->
<!--            const mouseY = e.offsetY;-->

<!--            draggedElement.x = mouseX;-->
<!--            draggedElement.y = mouseY;-->

<!--            redrawCanvas();-->
<!--        }-->
<!--    });-->

<!--    canvas.addEventListener('mouseup', function() {-->
<!--        draggedElement = null;-->
<!--    });-->

<!--    // Zapis zdjęcia z naklejkami i tekstem-->
<!--    document.querySelector('form').addEventListener('submit', function(event) {-->
<!--        event.preventDefault();-->

<!--        const editedPhotoData = document.getElementById('edited-photo-data');-->

<!--        // Rysowanie zdjęcia na canvas-->
<!--        context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--        context.drawImage(photo, 0, 0);-->

<!--        // Rysowanie elementów (naklejki, tekst) na canvas-->
<!--        elements.forEach((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--            } else if (element.type === 'text') {-->
<!--                context.font = `${element.fontSize}px Arial`;-->
<!--                context.fillStyle = element.color;-->
<!--                context.fillText(element.text, element.x, element.y);-->
<!--            }-->
<!--        });-->

<!--        // Ustawienie wygenerowanego zdjęcia do ukrytego inputa-->
<!--        editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--        // Wysłanie formularza-->
<!--        event.target.submit();-->
<!--    });-->
<!--</script>-->

<!--</body>-->
<!--</html>-->




<!--{% load static %}-->
<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edycja zdjęcia</title>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        canvas {-->
<!--            border: 1px solid black;-->
<!--        }-->

<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->

<!--        .sticker-btn img {-->
<!--            cursor: pointer;-->
<!--            width: 50px;-->
<!--            height: 50px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--<h1>Edytuj zdjęcie</h1>-->

<!--<div class="controls">-->
<!--    &lt;!&ndash; Wyświetl naklejki jako przyciski &ndash;&gt;-->
<!--    <h3>Dodaj naklejki:</h3>-->
<!--    {% for sticker in stickers %}-->
<!--        <button class="sticker-btn" onclick="addSticker('{{ MEDIA_URL }}stickers/{{ sticker }}')">-->
<!--            <img src="{{ MEDIA_URL }}stickers/{{ sticker }}" alt="Naklejka" width="50" height="50">-->
<!--        </button>-->
<!--    {% endfor %}-->
<!--</div>-->

<!--<div class="controls">-->
<!--    &lt;!&ndash; Przycisk dodawania tekstu &ndash;&gt;-->
<!--    <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--    <button onclick="addText()">Dodaj tekst</button>-->
<!--</div>-->

<!--&lt;!&ndash; Kontener dla canvas &ndash;&gt;-->
<!--<div class="canvas-container">-->
<!--    <canvas id="canvas"></canvas>-->
<!--</div>-->

<!--&lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--<form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--    {% csrf_token %}-->
<!--    <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--    <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--</form>-->

<!--<script>-->
<!--    let canvas = document.getElementById('canvas');-->
<!--    let context = canvas.getContext('2d');-->
<!--    let draggedElement = null;-->
<!--    let photo = new Image();-->
<!--    let elements = [];-->

<!--    // Ustawienie zdjęcia w tle canvas-->
<!--    photo.src = "{{ photo.image.url }}";-->
<!--    photo.onload = function() {-->
<!--        canvas.width = photo.width;-->
<!--        canvas.height = photo.height;-->
<!--        context.drawImage(photo, 0, 0);-->
<!--        redrawCanvas(); // Pierwsze rysowanie-->
<!--    };-->

<!--    // Funkcja dodająca naklejkę do canvas-->
<!--    function addSticker(stickerUrl) {-->
<!--        const sticker = new Image();-->
<!--        sticker.src = stickerUrl;-->

<!--        sticker.onload = function() {-->
<!--            // Sprawdzenie, czy obrazek został poprawnie załadowany-->
<!--            if (sticker.complete && sticker.naturalHeight !== 0) {-->
<!--                elements.push({-->
<!--                    type: 'sticker',-->
<!--                    image: sticker,-->
<!--                    x: 10,  // Początkowa pozycja naklejki-->
<!--                    y: 10,-->
<!--                    width: sticker.width / 2,  // Zmniejszenie rozmiaru naklejki-->
<!--                    height: sticker.height / 2-->
<!--                });-->
<!--                redrawCanvas(); // Aktualizacja canvas po dodaniu naklejki-->
<!--            } else {-->
<!--                console.error("Nie można załadować naklejki:", stickerUrl);-->
<!--            }-->
<!--        };-->

<!--        sticker.onerror = function() {-->
<!--            console.error("Błąd w ładowaniu naklejki:", stickerUrl);-->
<!--        };-->
<!--    }-->

<!--    // Funkcja dodająca tekst do canvas-->
<!--    function addText() {-->
<!--        const text = document.getElementById('text-to-add').value;-->
<!--        if (text.trim() !== '') {-->
<!--            elements.push({-->
<!--                type: 'text',-->
<!--                text: text,-->
<!--                x: 10,  // Początkowa pozycja tekstu-->
<!--                y: 50,-->
<!--                fontSize: 20,-->
<!--                color: 'black'-->
<!--            });-->
<!--            redrawCanvas();-->
<!--        }-->
<!--    }-->

<!--    // Przerysowanie całego canvas-->
<!--    function redrawCanvas() {-->
<!--        // Czyszczenie canvasu-->
<!--        context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--        context.drawImage(photo, 0, 0);-->

<!--        // Rysowanie elementów (naklejek i tekstu)-->
<!--        elements.forEach((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--            } else if (element.type === 'text') {-->
<!--                context.font = `${element.fontSize}px Arial`;-->
<!--                context.fillStyle = element.color;-->
<!--                context.fillText(element.text, element.x, element.y);-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // Zdarzenia przeciągania-->
<!--    canvas.addEventListener('mousedown', function(e) {-->
<!--        const mouseX = e.offsetX;-->
<!--        const mouseY = e.offsetY;-->

<!--        draggedElement = elements.find((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                return mouseX > element.x && mouseX < element.x + element.width &&-->
<!--                       mouseY > element.y && mouseY < element.y + element.height;-->
<!--            } else if (element.type === 'text') {-->
<!--                return mouseX > element.x && mouseX < element.x + context.measureText(element.text).width &&-->
<!--                       mouseY > element.y - element.fontSize && mouseY < element.y;-->
<!--            }-->
<!--            return false;-->
<!--        });-->
<!--    });-->

<!--    canvas.addEventListener('mousemove', function(e) {-->
<!--        if (draggedElement) {-->
<!--            const mouseX = e.offsetX;-->
<!--            const mouseY = e.offsetY;-->

<!--            draggedElement.x = mouseX;-->
<!--            draggedElement.y = mouseY;-->

<!--            redrawCanvas();-->
<!--        }-->
<!--    });-->

<!--    canvas.addEventListener('mouseup', function() {-->
<!--        draggedElement = null;-->
<!--    });-->

<!--    // Zapis zdjęcia z naklejkami i tekstem-->
<!--    document.querySelector('form').addEventListener('submit', function(event) {-->
<!--        event.preventDefault();-->

<!--        const editedPhotoData = document.getElementById('edited-photo-data');-->

<!--        // Rysowanie zdjęcia na canvas-->
<!--        context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--        context.drawImage(photo, 0, 0);-->

<!--        // Rysowanie elementów (naklejki, tekst) na canvas-->
<!--        elements.forEach((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--            } else if (element.type === 'text') {-->
<!--                context.font = `${element.fontSize}px Arial`;-->
<!--                context.fillStyle = element.color;-->
<!--                context.fillText(element.text, element.x, element.y);-->
<!--            }-->
<!--        });-->

<!--        // Ustawienie wygenerowanego zdjęcia do ukrytego inputa-->
<!--        editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--        // Wysłanie formularza-->
<!--        event.target.submit();-->
<!--    });-->
<!--</script>-->

<!--</body>-->
<!--</html>-->



<!--{% load static %}-->
<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edycja zdjęcia</title>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        canvas {-->
<!--            border: 1px solid black;-->
<!--        }-->

<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->

<!--        .sticker-btn img {-->
<!--            cursor: pointer;-->
<!--            width: 50px;-->
<!--            height: 50px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--<h1>Edytuj zdjęcie</h1>-->

<!--<div class="controls">-->
<!--    &lt;!&ndash; Wyświetl naklejki jako przyciski &ndash;&gt;-->
<!--    <h3>Dodaj naklejki:</h3>-->
<!--    {% for sticker in stickers %}-->
<!--        <button class="sticker-btn" onclick="addSticker('{{ MEDIA_URL }}stickers/{{ sticker }}')">-->
<!--            <img src="{{ MEDIA_URL }}stickers/{{ sticker }}" alt="Naklejka {{ sticker }}" width="50" height="50">-->
<!--        </button>-->
<!--    {% endfor %}-->
<!--</div>-->

<!--<div class="controls">-->
<!--    &lt;!&ndash; Przycisk dodawania tekstu &ndash;&gt;-->
<!--    <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--    <button onclick="addText()">Dodaj tekst</button>-->
<!--</div>-->

<!--&lt;!&ndash; Kontener dla canvas &ndash;&gt;-->
<!--<div class="canvas-container">-->
<!--    <canvas id="canvas"></canvas>-->
<!--</div>-->

<!--&lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--<form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--    {% csrf_token %}-->
<!--    <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--    <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--</form>-->

<!--<script>-->
<!--    let canvas = document.getElementById('canvas');-->
<!--    let context = canvas.getContext('2d');-->
<!--    let draggedElement = null;-->
<!--    let photo = new Image();-->
<!--    let elements = [];-->

<!--    // Ustawienie zdjęcia w tle canvas-->
<!--    photo.src = "{{ photo.image.url }}";-->
<!--    photo.onload = function() {-->
<!--        canvas.width = photo.width;-->
<!--        canvas.height = photo.height;-->
<!--        context.drawImage(photo, 0, 0);-->
<!--        redrawCanvas(); // Pierwsze rysowanie-->
<!--    };-->

<!--    // Funkcja dodająca naklejkę do canvas-->
<!--    function addSticker(stickerUrl) {-->
<!--        const sticker = new Image();-->
<!--        sticker.src = stickerUrl;-->

<!--        sticker.onload = function() {-->
<!--            // Sprawdzenie, czy obrazek został poprawnie załadowany-->
<!--            if (sticker.complete && sticker.naturalHeight !== 0) {-->
<!--                elements.push({-->
<!--                    type: 'sticker',-->
<!--                    image: sticker,-->
<!--                    x: 10,  // Początkowa pozycja naklejki-->
<!--                    y: 10,-->
<!--                    width: sticker.width / 2,  // Zmniejszenie rozmiaru naklejki-->
<!--                    height: sticker.height / 2-->
<!--                });-->
<!--                console.log("Naklejka dodana: " + stickerUrl); // Debugowanie-->
<!--                redrawCanvas(); // Aktualizacja canvas po dodaniu naklejki-->
<!--            } else {-->
<!--                console.error("Nie można załadować naklejki:", stickerUrl);-->
<!--            }-->
<!--        };-->

<!--        sticker.onerror = function() {-->
<!--            console.error("Błąd w ładowaniu naklejki:", stickerUrl);-->
<!--        };-->
<!--    }-->

<!--    // Funkcja dodająca tekst do canvas-->
<!--    function addText() {-->
<!--        const text = document.getElementById('text-to-add').value;-->
<!--        if (text.trim() !== '') {-->
<!--            elements.push({-->
<!--                type: 'text',-->
<!--                text: text,-->
<!--                x: 10,  // Początkowa pozycja tekstu-->
<!--                y: 50,-->
<!--                fontSize: 20,-->
<!--                color: 'black'-->
<!--            });-->
<!--            redrawCanvas();-->
<!--        }-->
<!--    }-->

<!--    // Przerysowanie całego canvas-->
<!--    function redrawCanvas() {-->
<!--        // Czyszczenie canvasu-->
<!--        context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--        context.drawImage(photo, 0, 0);-->

<!--        // Rysowanie elementów (naklejek i tekstu)-->
<!--        elements.forEach((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--            } else if (element.type === 'text') {-->
<!--                context.font = `${element.fontSize}px Arial`;-->
<!--                context.fillStyle = element.color;-->
<!--                context.fillText(element.text, element.x, element.y);-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // Zdarzenia przeciągania-->
<!--    canvas.addEventListener('mousedown', function(e) {-->
<!--        const mouseX = e.offsetX;-->
<!--        const mouseY = e.offsetY;-->

<!--        draggedElement = elements.find((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                return mouseX > element.x && mouseX < element.x + element.width &&-->
<!--                       mouseY > element.y && mouseY < element.y + element.height;-->
<!--            } else if (element.type === 'text') {-->
<!--                return mouseX > element.x && mouseX < element.x + context.measureText(element.text).width &&-->
<!--                       mouseY > element.y - element.fontSize && mouseY < element.y;-->
<!--            }-->
<!--            return false;-->
<!--        });-->
<!--    });-->

<!--    canvas.addEventListener('mousemove', function(e) {-->
<!--        if (draggedElement) {-->
<!--            const mouseX = e.offsetX;-->
<!--            const mouseY = e.offsetY;-->

<!--            draggedElement.x = mouseX;-->
<!--            draggedElement.y = mouseY;-->

<!--            redrawCanvas();-->
<!--        }-->
<!--    });-->

<!--    canvas.addEventListener('mouseup', function() {-->
<!--        draggedElement = null;-->
<!--    });-->

<!--    // Zapis zdjęcia z naklejkami i tekstem-->
<!--    document.querySelector('form').addEventListener('submit', function(event) {-->
<!--        event.preventDefault();-->

<!--        const editedPhotoData = document.getElementById('edited-photo-data');-->

<!--        // Rysowanie zdjęcia na canvas-->
<!--        context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--        context.drawImage(photo, 0, 0);-->

<!--        // Rysowanie elementów (naklejki, tekst) na canvas-->
<!--        elements.forEach((element) => {-->
<!--            if (element.type === 'sticker') {-->
<!--                context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--            } else if (element.type === 'text') {-->
<!--                context.font = `${element.fontSize}px Arial`;-->
<!--                context.fillStyle = element.color;-->
<!--                context.fillText(element.text, element.x, element.y);-->
<!--            }-->
<!--        });-->

<!--        // Ustawienie wygenerowanego zdjęcia do ukrytego inputa-->
<!--        editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--        // Wysłanie formularza-->
<!--        event.target.submit();-->
<!--    });-->
<!--</script>-->

<!--</body>-->
<!--</html>-->




<!--<!DOCTYPE html>-->
<!--<html lang="pl">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edytuj zdjęcie</title>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        canvas {-->
<!--            border: 1px solid black;-->
<!--        }-->

<!--        .sticker-btn img {-->
<!--            border: 1px solid #ccc;-->
<!--            margin-right: 5px;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--    <h1>Edytuj zdjęcie</h1>-->

<!--    &lt;!&ndash; Sekcja dodawania naklejek &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <h3>Dodaj naklejki:</h3>-->
<!--        {% for sticker in stickers %}-->
<!--            <button class="sticker-btn" onclick="addSticker('{{ sticker.image.url }}')">-->
<!--                <img src="{{ sticker.image.url }}" alt="Naklejka" width="50" height="50">-->
<!--            </button>-->
<!--        {% endfor %}-->
<!--    </div>-->

<!--    &lt;!&ndash; Sekcja dodawania tekstu &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--        <button onclick="addText()">Dodaj tekst</button>-->
<!--    </div>-->

<!--    &lt;!&ndash; Canvas do edycji zdjęcia &ndash;&gt;-->
<!--    <div class="canvas-container">-->
<!--        <canvas id="canvas"></canvas>-->
<!--    </div>-->

<!--    &lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--    <form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--        {% csrf_token %}-->
<!--        <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--        <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--    </form>-->

<!--    <script>-->
<!--        let canvas = document.getElementById('canvas');-->
<!--        let context = canvas.getContext('2d');-->
<!--        let draggedElement = null;-->
<!--        let photo = new Image();-->
<!--        let elements = [];-->

<!--        // Ustawienie zdjęcia w tle canvas-->
<!--        photo.src = "{{ photo.image.url }}";-->
<!--        photo.onload = function() {-->
<!--            canvas.width = photo.width;-->
<!--            canvas.height = photo.height;-->
<!--            context.drawImage(photo, 0, 0);-->
<!--        };-->

<!--        // Funkcja dodająca naklejkę do canvas-->
<!--        function addSticker(stickerUrl) {-->
<!--            const sticker = new Image();-->
<!--            sticker.src = stickerUrl;-->
<!--            sticker.onload = function() {-->
<!--                elements.push({-->
<!--                    type: 'sticker',-->
<!--                    image: sticker,-->
<!--                    x: 10,-->
<!--                    y: 10,-->
<!--                    width: sticker.width / 2, // Skalowanie naklejki-->
<!--                    height: sticker.height / 2-->
<!--                });-->
<!--                redrawCanvas();-->
<!--            };-->
<!--        }-->

<!--        // Funkcja dodająca tekst do canvas-->
<!--        function addText() {-->
<!--            const text = document.getElementById('text-to-add').value;-->
<!--            if (text.trim() !== '') {-->
<!--                elements.push({-->
<!--                    type: 'text',-->
<!--                    text: text,-->
<!--                    x: 10,-->
<!--                    y: 50,-->
<!--                    fontSize: 20,-->
<!--                    color: 'black'-->
<!--                });-->
<!--                redrawCanvas();-->
<!--            }-->
<!--        }-->

<!--        // Przerysowanie całego canvas-->
<!--        function redrawCanvas() {-->
<!--            context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--            context.drawImage(photo, 0, 0);-->

<!--            elements.forEach((element) => {-->
<!--                if (element.type === 'sticker') {-->
<!--                    context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--                } else if (element.type === 'text') {-->
<!--                    context.font = `${element.fontSize}px Arial`;-->
<!--                    context.fillStyle = element.color;-->
<!--                    context.fillText(element.text, element.x, element.y);-->
<!--                }-->
<!--            });-->
<!--        }-->

<!--        // Zdarzenia przeciągania-->
<!--        canvas.addEventListener('mousedown', function(e) {-->
<!--            const mouseX = e.offsetX;-->
<!--            const mouseY = e.offsetY;-->

<!--            draggedElement = elements.find((element) => {-->
<!--                if (element.type === 'sticker') {-->
<!--                    return mouseX > element.x && mouseX < element.x + element.width &&-->
<!--                           mouseY > element.y && mouseY < element.y + element.height;-->
<!--                } else if (element.type === 'text') {-->
<!--                    return mouseX > element.x && mouseX < element.x + context.measureText(element.text).width &&-->
<!--                           mouseY > element.y - element.fontSize && mouseY < element.y;-->
<!--                }-->
<!--                return false;-->
<!--            });-->
<!--        });-->

<!--        canvas.addEventListener('mousemove', function(e) {-->
<!--            if (draggedElement) {-->
<!--                const mouseX = e.offsetX;-->
<!--                const mouseY = e.offsetY;-->

<!--                draggedElement.x = mouseX;-->
<!--                draggedElement.y = mouseY;-->

<!--                redrawCanvas();-->
<!--            }-->
<!--        });-->

<!--        canvas.addEventListener('mouseup', function() {-->
<!--            draggedElement = null;-->
<!--        });-->

<!--        // Zapis zdjęcia z naklejkami i tekstem-->
<!--        document.querySelector('form').addEventListener('submit', function(event) {-->
<!--            event.preventDefault();-->

<!--            const editedPhotoData = document.getElementById('edited-photo-data');-->

<!--            // Rysowanie zdjęcia na canvas-->
<!--            context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--            context.drawImage(photo, 0, 0);-->

<!--            // Rysowanie elementów (naklejki, tekst) na canvas-->
<!--            elements.forEach((element) => {-->
<!--                if (element.type === 'sticker') {-->
<!--                    context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--                } else if (element.type === 'text') {-->
<!--                    context.font = `${element.fontSize}px Arial`;-->
<!--                    context.fillStyle = element.color;-->
<!--                    context.fillText(element.text, element.x, element.y);-->
<!--                }-->
<!--            });-->

<!--            // Ustawienie wygenerowanego zdjęcia do ukrytego inputa-->
<!--            editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--            // Wysłanie formularza-->
<!--            event.target.submit();-->
<!--        });-->
<!--    </script>-->
<!--</body>-->
<!--</html>-->




{% load static %}
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edytuj zdjęcie</title>
    <style>
        .controls {
            margin-bottom: 20px;
        }

        .canvas-container {
            position: relative;
        }

        canvas {
            border: 1px solid black;
        }

        .sticker-btn img {
            border: 1px solid #ccc;
            margin-right: 5px;
            cursor: pointer;
        }

        .text-input {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>Edytuj zdjęcie</h1>

    <!-- Sekcja dodawania naklejek -->
    <div class="controls">
        <h3>Dodaj naklejki:</h3>
        {% for sticker in stickers %}
            <button class="sticker-btn" onclick="addSticker('{{ sticker.image.url }}')">
                <img src="{{ sticker.image.url }}" alt="{{ sticker.image }}">
            </button>
        {% endfor %}
    </div>

    <!-- Sekcja dodawania tekstu -->
    <div class="controls">
        <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">
        <button onclick="addText()">Dodaj tekst</button>
    </div>

    <!-- Canvas do edycji zdjęcia -->
    <div class="canvas-container">
        <canvas id="canvas"></canvas>
    </div>

    <!-- Przycisk zapisywania zdjęcia -->
    <form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">
        {% csrf_token %}
        <input type="hidden" id="edited-photo-data" name="edited_photo_data">
        <button type="submit" id="save-btn">Zapisz zdjęcie</button>
    </form>

    <script>
        let canvas = document.getElementById('canvas');
        let context = canvas.getContext('2d');
        let draggedElement = null;
        let photo = new Image();
        let elements = [];

        // Ustawienie zdjęcia w tle canvas
        photo.src = "{{ photo.image.url }}";
        photo.onload = function() {
            canvas.width = photo.width;
            canvas.height = photo.height;
            context.drawImage(photo, 0, 0);
        };

        // Funkcja dodająca naklejkę do canvas
        function addSticker(stickerUrl) {
            const sticker = new Image();
            sticker.src = stickerUrl;
            sticker.onload = function() {
                elements.push({
                    type: 'sticker',
                    image: sticker,
                    x: 10,
                    y: 10,
                    width: sticker.width / 2, // Skalowanie naklejki
                    height: sticker.height / 2
                });
                redrawCanvas();
            };
        }

        // Funkcja dodająca tekst do canvas
        function addText() {
            const text = document.getElementById('text-to-add').value;
            if (text.trim() !== '') {
                elements.push({
                    type: 'text',
                    text: text,
                    x: 10,
                    y: 50,
                    fontSize: 20,
                    color: 'black'
                });
                redrawCanvas();
            }
        }

        // Przerysowanie całego canvas
        function redrawCanvas() {
            context.clearRect(0, 0, canvas.width, canvas.height);
            context.drawImage(photo, 0, 0);

            elements.forEach((element) => {
                if (element.type === 'sticker') {
                    context.drawImage(element.image, element.x, element.y, element.width, element.height);
                } else if (element.type === 'text') {
                    context.font = `${element.fontSize}px Arial`;
                    context.fillStyle = element.color;
                    context.fillText(element.text, element.x, element.y);
                }
            });
        }

        // Zdarzenia przeciągania
        canvas.addEventListener('mousedown', function(e) {
            const mouseX = e.offsetX;
            const mouseY = e.offsetY;

            draggedElement = elements.find((element) => {
                if (element.type === 'sticker') {
                    return mouseX > element.x && mouseX < element.x + element.width &&
                           mouseY > element.y && mouseY < element.y + element.height;
                } else if (element.type === 'text') {
                    return mouseX > element.x && mouseX < element.x + context.measureText(element.text).width &&
                           mouseY > element.y - element.fontSize && mouseY < element.y;
                }
                return false;
            });
        });

        canvas.addEventListener('mousemove', function(e) {
            if (draggedElement) {
                const mouseX = e.offsetX;
                const mouseY = e.offsetY;

                draggedElement.x = mouseX;
                draggedElement.y = mouseY;

                redrawCanvas();
            }
        });

        canvas.addEventListener('mouseup', function() {
            draggedElement = null;
        });

        // Zapis zdjęcia z naklejkami i tekstem
        document.querySelector('form').addEventListener('submit', function(event) {
            event.preventDefault();

            const editedPhotoData = document.getElementById('edited-photo-data');

            // Rysowanie zdjęcia na canvas
            context.clearRect(0, 0, canvas.width, canvas.height);
            context.drawImage(photo, 0, 0);

            // Rysowanie elementów (naklejki, tekst) na canvas
            elements.forEach((element) => {
                if (element.type === 'sticker') {
                    context.drawImage(element.image, element.x, element.y, element.width, element.height);
                } else if (element.type === 'text') {
                    context.font = `${element.fontSize}px Arial`;
                    context.fillStyle = element.color;
                    context.fillText(element.text, element.x, element.y);
                }
            });

            // Ustawienie wygenerowanego zdjęcia do ukrytego inputa
            editedPhotoData.value = canvas.toDataURL('image/png');

            // Wysłanie formularza
            event.target.submit();
        });
    </script>
</body>
</html>




<!--<!DOCTYPE html>-->
<!--<html lang="pl">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edytuj zdjęcie</title>-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.6.0/fabric.min.js"></script>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        .sticker-btn img {-->
<!--            border: 1px solid #ccc;-->
<!--            margin-right: 5px;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--    <h1>Edytuj zdjęcie</h1>-->

<!--    &lt;!&ndash; Sekcja dodawania naklejek &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <h3>Dodaj naklejki:</h3>-->
<!--        {% for sticker in stickers %}-->
<!--            <button class="sticker-btn" onclick="addSticker('{{ sticker.image.url }}')">-->
<!--                <img src="{{ sticker.image.url }}" alt="Naklejka" width="50" height="50">-->
<!--            </button>-->
<!--        {% endfor %}-->
<!--    </div>-->

<!--    &lt;!&ndash; Sekcja dodawania tekstu &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--        <button onclick="addText()">Dodaj tekst</button>-->
<!--    </div>-->

<!--    &lt;!&ndash; Canvas do edycji zdjęcia &ndash;&gt;-->
<!--    <div class="canvas-container">-->
<!--        <canvas id="canvas"></canvas>-->
<!--    </div>-->

<!--    &lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--    <form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--        {% csrf_token %}-->
<!--        <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--        <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--    </form>-->

<!--    <script>-->
<!--        let canvas = new fabric.Canvas('canvas');-->
<!--        let photo = new Image();-->

<!--        // Ustawienie zdjęcia w tle canvas-->
<!--        photo.src = "{{ photo.image.url }}";-->
<!--        photo.onload = function() {-->
<!--            let imgInstance = new fabric.Image(photo, {-->
<!--                left: 0,-->
<!--                top: 0,-->
<!--                selectable: false-->
<!--            });-->
<!--            canvas.setWidth(photo.width);-->
<!--            canvas.setHeight(photo.height);-->
<!--            canvas.add(imgInstance);-->
<!--            canvas.sendToBack(imgInstance);-->
<!--        };-->

<!--        // Funkcja dodająca naklejkę do canvas-->
<!--        function addSticker(stickerUrl) {-->
<!--            fabric.Image.fromURL(stickerUrl, function(img) {-->
<!--                img.scale(0.5);  // Skalowanie naklejki-->
<!--                canvas.add(img);-->
<!--            });-->
<!--        }-->

<!--        // Funkcja dodająca tekst do canvas-->
<!--        function addText() {-->
<!--            const text = document.getElementById('text-to-add').value;-->
<!--            if (text.trim() !== '') {-->
<!--                const textObj = new fabric.Text(text, {-->
<!--                    left: 10,-->
<!--                    top: 50,-->
<!--                    fontSize: 20,-->
<!--                    fill: 'black'-->
<!--                });-->
<!--                canvas.add(textObj);-->
<!--            }-->
<!--        }-->

<!--        // Zapis zdjęcia z naklejkami i tekstem-->
<!--        document.querySelector('form').addEventListener('submit', function(event) {-->
<!--            event.preventDefault();-->

<!--            // Konwersja canvas na obrazek w formacie dataURL-->
<!--            const editedPhotoData = document.getElementById('edited-photo-data');-->
<!--            editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--            // Wysłanie formularza-->
<!--            event.target.submit();-->
<!--        });-->
<!--    </script>-->
<!--</body>-->
<!--</html>-->




<!--<!DOCTYPE html>-->
<!--<html lang="pl">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edytuj zdjęcie</title>-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.6.0/fabric.min.js"></script>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        .sticker-btn img {-->
<!--            border: 1px solid #ccc;-->
<!--            margin-right: 5px;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--    <h1>Edytuj zdjęcie</h1>-->

<!--    &lt;!&ndash; Sekcja dodawania naklejek &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <h3>Dodaj naklejki:</h3>-->
<!--        {% for sticker in stickers %}-->
<!--            <button class="sticker-btn" onclick="addSticker('{{ sticker.image.url }}')">-->
<!--                <img src="{{ sticker.image.url }}" alt="Naklejka" width="50" height="50">-->
<!--            </button>-->
<!--        {% endfor %}-->
<!--    </div>-->

<!--    &lt;!&ndash; Sekcja dodawania tekstu &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--        <button onclick="addText()">Dodaj tekst</button>-->
<!--    </div>-->

<!--    &lt;!&ndash; Canvas do edycji zdjęcia &ndash;&gt;-->
<!--    <div class="canvas-container">-->
<!--        <canvas id="canvas"></canvas>-->
<!--    </div>-->

<!--    &lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--    <form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--        {% csrf_token %}-->
<!--        <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--        <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--    </form>-->

<!--    <script>-->
<!--        let canvas = new fabric.Canvas('canvas');-->
<!--        let photo = new Image();-->

<!--        // Testowo przypisujemy ścieżkę do obrazu-->
<!--        let imageUrl = "/media/photos/example.png"; // Zaktualizuj tę ścieżkę testowo-->
<!--        if ("{{ photo.image.url }}") {-->
<!--            imageUrl = "{{ photo.image.url }}"; // Używamy ścieżki z Django-->
<!--        }-->

<!--        // Ustawienie zdjęcia w tle canvas-->
<!--        photo.src = imageUrl;-->
<!--        photo.onload = function() {-->
<!--            let imgInstance = new fabric.Image(photo, {-->
<!--                left: 0,-->
<!--                top: 0,-->
<!--                selectable: false-->
<!--            });-->
<!--            canvas.setWidth(photo.width);-->
<!--            canvas.setHeight(photo.height);-->
<!--            canvas.add(imgInstance);-->
<!--            canvas.sendToBack(imgInstance);-->
<!--        };-->

<!--        // Funkcja dodająca naklejkę do canvas-->
<!--        function addSticker(stickerUrl) {-->
<!--            fabric.Image.fromURL(stickerUrl, function(img) {-->
<!--                img.scale(0.5);  // Skalowanie naklejki-->
<!--                canvas.add(img);-->
<!--            });-->
<!--        }-->

<!--        // Funkcja dodająca tekst do canvas-->
<!--        function addText() {-->
<!--            const text = document.getElementById('text-to-add').value;-->
<!--            if (text.trim() !== '') {-->
<!--                const textObj = new fabric.Text(text, {-->
<!--                    left: 10,-->
<!--                    top: 50,-->
<!--                    fontSize: 20,-->
<!--                    fill: 'black'-->
<!--                });-->
<!--                canvas.add(textObj);-->
<!--            }-->
<!--        }-->

<!--        // Zapis zdjęcia z naklejkami i tekstem-->
<!--        document.querySelector('form').addEventListener('submit', function(event) {-->
<!--            event.preventDefault();-->

<!--            // Konwersja canvas na obrazek w formacie dataURL-->
<!--            const editedPhotoData = document.getElementById('edited-photo-data');-->
<!--            editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--            // Wysłanie formularza-->
<!--            event.target.submit();-->
<!--        });-->
<!--    </script>-->
<!--</body>-->
<!--</html>-->



<!--<!DOCTYPE html>-->
<!--<html lang="pl">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edytuj zdjęcie</title>-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.6.0/fabric.min.js"></script>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        .sticker-btn img {-->
<!--            border: 1px solid #ccc;-->
<!--            margin-right: 5px;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--    <h1>Edytuj zdjęcie</h1>-->

<!--    &lt;!&ndash; Bezpośrednie wyświetlanie obrazu &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <h3>Oryginalne zdjęcie:</h3>-->
<!--        <img src="{{ photo.image.url }}" alt="Zdjęcie do edycji" id="original-photo" width="500">-->
<!--    </div>-->

<!--    &lt;!&ndash; Sekcja dodawania naklejek &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <h3>Dodaj naklejki:</h3>-->
<!--        {% for sticker in stickers %}-->
<!--            <button class="sticker-btn" onclick="addSticker('{{ sticker.image.url }}')">-->
<!--                <img src="{{ sticker.image.url }}" alt="Naklejka" width="50" height="50">-->
<!--            </button>-->
<!--        {% endfor %}-->
<!--    </div>-->

<!--    &lt;!&ndash; Sekcja dodawania tekstu &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--        <button onclick="addText()">Dodaj tekst</button>-->
<!--    </div>-->

<!--    &lt;!&ndash; Canvas do edycji zdjęcia &ndash;&gt;-->
<!--    <div class="canvas-container">-->
<!--        <canvas id="canvas"></canvas>-->
<!--    </div>-->

<!--    &lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--    <form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--        {% csrf_token %}-->
<!--        <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--        <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--    </form>-->

<!--    <script>-->
<!--        let canvas = new fabric.Canvas('canvas');-->
<!--        let photo = new Image();-->

<!--        // Testowo przypisujemy ścieżkę do obrazu-->
<!--        let imageUrl = document.getElementById('original-photo').src;-->
<!--        photo.src = imageUrl;-->
<!--        photo.onload = function() {-->
<!--            let imgInstance = new fabric.Image(photo, {-->
<!--                left: 0,-->
<!--                top: 0,-->
<!--                selectable: false-->
<!--            });-->
<!--            canvas.setWidth(photo.width);-->
<!--            canvas.setHeight(photo.height);-->
<!--            canvas.add(imgInstance);-->
<!--            canvas.sendToBack(imgInstance);-->
<!--        };-->

<!--        // Funkcja dodająca naklejkę do canvas-->
<!--        function addSticker(stickerUrl) {-->
<!--            fabric.Image.fromURL(stickerUrl, function(img) {-->
<!--                img.scale(0.5);  // Skalowanie naklejki-->
<!--                canvas.add(img);-->
<!--            });-->
<!--        }-->

<!--        // Funkcja dodająca tekst do canvas-->
<!--        function addText() {-->
<!--            const text = document.getElementById('text-to-add').value;-->
<!--            if (text.trim() !== '') {-->
<!--                const textObj = new fabric.Text(text, {-->
<!--                    left: 10,-->
<!--                    top: 50,-->
<!--                    fontSize: 20,-->
<!--                    fill: 'black'-->
<!--                });-->
<!--                canvas.add(textObj);-->
<!--            }-->
<!--        }-->

<!--        // Zapis zdjęcia z naklejkami i tekstem-->
<!--        document.querySelector('form').addEventListener('submit', function(event) {-->
<!--            event.preventDefault();-->

<!--            // Konwersja canvas na obrazek w formacie dataURL-->
<!--            const editedPhotoData = document.getElementById('edited-photo-data');-->
<!--            editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--            // Wysłanie formularza-->
<!--            event.target.submit();-->
<!--        });-->
<!--    </script>-->
<!--</body>-->
<!--</html>-->




<!--<!DOCTYPE html>-->
<!--<html lang="pl">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edytuj zdjęcie</title>-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.6.0/fabric.min.js"></script>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        .sticker-btn img {-->
<!--            border: 1px solid #ccc;-->
<!--            margin-right: 5px;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--    <h1>Edytuj zdjęcie</h1>-->

<!--    &lt;!&ndash; Sekcja dodawania naklejek &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <h3>Dodaj naklejki:</h3>-->
<!--        {% for sticker in stickers %}-->
<!--            <button class="sticker-btn" onclick="addSticker('{{ sticker.image.url }}')">-->
<!--                <img src="{{ sticker.image.url }}" alt="Naklejka" width="50" height="50">-->
<!--            </button>-->
<!--        {% endfor %}-->
<!--    </div>-->

<!--    &lt;!&ndash; Sekcja dodawania tekstu &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--        <button onclick="addText()">Dodaj tekst</button>-->
<!--    </div>-->

<!--    &lt;!&ndash; Canvas do edycji zdjęcia &ndash;&gt;-->
<!--    <div class="canvas-container">-->
<!--        <canvas id="canvas"></canvas>-->
<!--    </div>-->

<!--    &lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--    <form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--        {% csrf_token %}-->
<!--        <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--        <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--    </form>-->

<!--    <script>-->
<!--        let canvas = new fabric.Canvas('canvas');-->
<!--        let photo = new Image();-->

<!--        // Ustawienie ścieżki do obrazu do edycji-->
<!--        let imageUrl = '{{ photo.image.url }}';-->
<!--        photo.src = imageUrl;-->
<!--        photo.onload = function() {-->
<!--            let imgInstance = new fabric.Image(photo, {-->
<!--                left: 0,-->
<!--                top: 0,-->
<!--                selectable: false-->
<!--            });-->
<!--            canvas.setWidth(photo.width);-->
<!--            canvas.setHeight(photo.height);-->
<!--            canvas.add(imgInstance);-->
<!--            canvas.sendToBack(imgInstance);-->
<!--        };-->

<!--        // Funkcja dodająca naklejkę do canvas-->
<!--        function addSticker(stickerUrl) {-->
<!--            fabric.Image.fromURL(stickerUrl, function(img) {-->
<!--                img.scale(0.5);  // Skalowanie naklejki-->
<!--                canvas.add(img);-->
<!--            });-->
<!--        }-->

<!--        // Funkcja dodająca tekst do canvas-->
<!--        function addText() {-->
<!--            const text = document.getElementById('text-to-add').value;-->
<!--            if (text.trim() !== '') {-->
<!--                const textObj = new fabric.Text(text, {-->
<!--                    left: 10,-->
<!--                    top: 50,-->
<!--                    fontSize: 20,-->
<!--                    fill: 'black'-->
<!--                });-->
<!--                canvas.add(textObj);-->
<!--            }-->
<!--        }-->

<!--        // Zapis zdjęcia z naklejkami i tekstem-->
<!--        document.querySelector('form').addEventListener('submit', function(event) {-->
<!--            event.preventDefault();-->

<!--            // Konwersja canvas na obrazek w formacie dataURL-->
<!--            const editedPhotoData = document.getElementById('edited-photo-data');-->
<!--            editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--            // Wysłanie formularza-->
<!--            event.target.submit();-->
<!--        });-->
<!--    </script>-->
<!--</body>-->
<!--</html>-->



<!--<!DOCTYPE html>-->
<!--<html lang="pl">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edytuj zdjęcie</title>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        canvas {-->
<!--            border: 1px solid black;-->
<!--        }-->

<!--        .sticker-btn img {-->
<!--            border: 1px solid #ccc;-->
<!--            margin-right: 5px;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--    <h1>Edytuj zdjęcie</h1>-->

<!--    &lt;!&ndash; Sekcja dodawania naklejek &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <h3>Dodaj naklejki:</h3>-->
<!--        {% for sticker in stickers %}-->
<!--            <button class="sticker-btn" onclick="addSticker('{{ sticker.image.url }}')">-->
<!--                <img src="{{ sticker.image.url }}" alt="Naklejka" width="50" height="50">-->
<!--            </button>-->
<!--        {% endfor %}-->
<!--    </div>-->

<!--    &lt;!&ndash; Sekcja dodawania tekstu &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--        <button onclick="addText()">Dodaj tekst</button>-->
<!--    </div>-->

<!--    &lt;!&ndash; Canvas do edycji zdjęcia &ndash;&gt;-->
<!--    <div class="canvas-container">-->
<!--        <canvas id="canvas"></canvas>-->
<!--    </div>-->

<!--    &lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--    <form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--        {% csrf_token %}-->
<!--        <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--        <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--    </form>-->

<!--    <script>-->
<!--        let canvas = document.getElementById('canvas');-->
<!--        let context = canvas.getContext('2d');-->
<!--        let draggedElement = null;-->
<!--        let photo = new Image();-->
<!--        let elements = [];-->

<!--        // Ustawienie zdjęcia w tle canvas-->
<!--        photo.src = "{{ photo.image.url }}";-->
<!--        photo.onload = function() {-->
<!--            canvas.width = photo.width;-->
<!--            canvas.height = photo.height;-->
<!--            context.drawImage(photo, 0, 0);-->
<!--        };-->

<!--        // Funkcja dodająca naklejkę do canvas-->
<!--        function addSticker(stickerUrl) {-->
<!--            const sticker = new Image();-->
<!--            sticker.src = stickerUrl;-->
<!--            sticker.onload = function() {-->
<!--                elements.push({-->
<!--                    type: 'sticker',-->
<!--                    image: sticker,-->
<!--                    x: 10,-->
<!--                    y: 10,-->
<!--                    width: sticker.width / 2, // Skalowanie naklejki-->
<!--                    height: sticker.height / 2-->
<!--                });-->
<!--                redrawCanvas();-->
<!--            };-->
<!--        }-->

<!--        // Funkcja dodająca tekst do canvas-->
<!--        function addText() {-->
<!--            const text = document.getElementById('text-to-add').value;-->
<!--            if (text.trim() !== '') {-->
<!--                elements.push({-->
<!--                    type: 'text',-->
<!--                    text: text,-->
<!--                    x: 10,-->
<!--                    y: 50,-->
<!--                    fontSize: 20,-->
<!--                    color: 'black'-->
<!--                });-->
<!--                redrawCanvas();-->
<!--            }-->
<!--        }-->

<!--        // Przerysowanie całego canvas-->
<!--        function redrawCanvas() {-->
<!--            context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--            context.drawImage(photo, 0, 0);-->

<!--            elements.forEach((element) => {-->
<!--                if (element.type === 'sticker') {-->
<!--                    context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--                } else if (element.type === 'text') {-->
<!--                    context.font = `${element.fontSize}px Arial`;-->
<!--                    context.fillStyle = element.color;-->
<!--                    context.fillText(element.text, element.x, element.y);-->
<!--                }-->
<!--            });-->
<!--        }-->

<!--        // Zdarzenia przeciągania-->
<!--        canvas.addEventListener('mousedown', function(e) {-->
<!--            const mouseX = e.offsetX;-->
<!--            const mouseY = e.offsetY;-->

<!--            draggedElement = elements.find((element) => {-->
<!--                if (element.type === 'sticker') {-->
<!--                    return mouseX > element.x && mouseX < element.x + element.width &&-->
<!--                           mouseY > element.y && mouseY < element.y + element.height;-->
<!--                } else if (element.type === 'text') {-->
<!--                    return mouseX > element.x && mouseX < element.x + context.measureText(element.text).width &&-->
<!--                           mouseY > element.y - element.fontSize && mouseY < element.y;-->
<!--                }-->
<!--                return false;-->
<!--            });-->
<!--        });-->

<!--        canvas.addEventListener('mousemove', function(e) {-->
<!--            if (draggedElement) {-->
<!--                const mouseX = e.offsetX;-->
<!--                const mouseY = e.offsetY;-->

<!--                draggedElement.x = mouseX;-->
<!--                draggedElement.y = mouseY;-->

<!--                redrawCanvas();-->
<!--            }-->
<!--        });-->

<!--        canvas.addEventListener('mouseup', function() {-->
<!--            draggedElement = null;-->
<!--        });-->

<!--        // Zapis zdjęcia z naklejkami i tekstem-->
<!--        document.querySelector('form').addEventListener('submit', function(event) {-->
<!--            event.preventDefault();-->

<!--            const editedPhotoData = document.getElementById('edited-photo-data');-->

<!--            // Rysowanie zdjęcia na canvas-->
<!--            context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--            context.drawImage(photo, 0, 0);-->

<!--            // Rysowanie elementów (naklejki, tekst) na canvas-->
<!--            elements.forEach((element) => {-->
<!--                if (element.type === 'sticker') {-->
<!--                    context.drawImage(element.image, element.x, element.y, element.width, element.height);-->
<!--                } else if (element.type === 'text') {-->
<!--                    context.font = `${element.fontSize}px Arial`;-->
<!--                    context.fillStyle = element.color;-->
<!--                    context.fillText(element.text, element.x, element.y);-->
<!--                }-->
<!--            });-->

<!--            // Ustawienie wygenerowanego zdjęcia do ukrytego inputa-->
<!--            editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--            // Wysłanie formularza-->
<!--            event.target.submit();-->
<!--        });-->
<!--    </script>-->
<!--</body>-->
<!--</html>-->



<!--<!DOCTYPE html>-->
<!--<html lang="pl">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Edytuj zdjęcie</title>-->
<!--    <style>-->
<!--        .controls {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .canvas-container {-->
<!--            position: relative;-->
<!--        }-->

<!--        canvas {-->
<!--            border: 1px solid black;-->
<!--            display: block;-->
<!--        }-->



<!--        .text-input {-->
<!--            margin-right: 10px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--    <h1>Edytuj zdjęcie</h1>-->

<!--    &lt;!&ndash; Sekcja dodawania naklejek &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <h3>Dodaj naklejki:</h3>-->
<!--        {% for sticker in stickers %}-->
<!--            <div>-->
<!--                <img src="{{ sticker.image.url }}" alt="Naklejka">-->
<!--                <button class="sticker-btn" onclick="addSticker('{{ sticker.image.url }}')">-->
<!--                    <img src="{{ sticker.image.url }}" alt="Naklejka">-->
<!--                </button>-->
<!--            </div>-->
<!--        {% endfor %}-->
<!--    </div>-->

<!--    &lt;!&ndash; Sekcja dodawania tekstu &ndash;&gt;-->
<!--    <div class="controls">-->
<!--        <input type="text" id="text-to-add" class="text-input" placeholder="Wpisz tekst">-->
<!--        <button onclick="addText()">Dodaj tekst</button>-->
<!--    </div>-->

<!--    &lt;!&ndash; Canvas do edycji zdjęcia &ndash;&gt;-->
<!--    <div class="canvas-container" id="canvas-container">-->
<!--        <canvas id="canvas"></canvas>-->
<!--    </div>-->

<!--    &lt;!&ndash; Przycisk zapisywania zdjęcia &ndash;&gt;-->
<!--    <form method="post" enctype="multipart/form-data" action="{% url 'save_edited_photo' photo.id %}">-->
<!--        {% csrf_token %}-->
<!--        <input type="hidden" id="edited-photo-data" name="edited_photo_data">-->
<!--        <button type="submit" id="save-btn">Zapisz zdjęcie</button>-->
<!--    </form>-->

<!--    <script>-->
<!--        let canvas = document.getElementById('canvas');-->
<!--        let context = canvas.getContext('2d');-->
<!--        let photo = new Image();-->
<!--        let elements = [];-->
<!--        let container = document.getElementById('canvas-container');-->

<!--        // Ustawienie zdjęcia w tle canvas-->
<!--        photo.src = "{{ photo.image.url }}";-->
<!--        photo.onload = function() {-->
<!--            canvas.width = photo.width;-->
<!--            canvas.height = photo.height;-->
<!--            context.drawImage(photo, 0, 0);-->
<!--        };-->

<!--        // Funkcja dodająca naklejkę jako HTML <img>-->
<!--        function addSticker(stickerUrl) {-->
<!--            const sticker = document.createElement('img');-->
<!--            sticker.src = stickerUrl;-->
<!--            sticker.classList.add('sticker');-->
<!--            sticker.style.left = '10px';-->
<!--            sticker.style.top = '10px';-->
<!--            sticker.draggable = true;-->
<!--            container.appendChild(sticker);-->

<!--            // Obsługa przeciągania naklejek-->
<!--            let offsetX, offsetY;-->

<!--            sticker.addEventListener('mousedown', function (e) {-->
<!--                offsetX = e.offsetX;-->
<!--                offsetY = e.offsetY;-->
<!--                window.addEventListener('mousemove', moveSticker);-->
<!--                window.addEventListener('mouseup', stopSticker);-->
<!--            });-->

<!--            function moveSticker(e) {-->
<!--                sticker.style.left = e.pageX - offsetX + 'px';-->
<!--                sticker.style.top = e.pageY - offsetY + 'px';-->
<!--            }-->

<!--            function stopSticker() {-->
<!--                window.removeEventListener('mousemove', moveSticker);-->
<!--                window.removeEventListener('mouseup', stopSticker);-->
<!--            }-->
<!--        }-->

<!--        // Funkcja dodająca tekst na canvas-->
<!--        function addText() {-->
<!--            const text = document.getElementById('text-to-add').value;-->
<!--            if (text.trim() !== '') {-->
<!--                elements.push({-->
<!--                    type: 'text',-->
<!--                    text: text,-->
<!--                    x: 10,-->
<!--                    y: 50,-->
<!--                    fontSize: 20,-->
<!--                    color: 'black'-->
<!--                });-->
<!--                redrawCanvas();-->
<!--            }-->
<!--        }-->

<!--        // Przerysowanie całego canvas-->
<!--        function redrawCanvas() {-->
<!--            context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--            context.drawImage(photo, 0, 0);-->

<!--            elements.forEach((element) => {-->
<!--                if (element.type === 'text') {-->
<!--                    context.font = `${element.fontSize}px Arial`;-->
<!--                    context.fillStyle = element.color;-->
<!--                    context.fillText(element.text, element.x, element.y);-->
<!--                }-->
<!--            });-->
<!--        }-->

<!--        // Zapis zdjęcia z naklejkami i tekstem-->
<!--        document.querySelector('form').addEventListener('submit', function(event) {-->
<!--            event.preventDefault();-->

<!--            // Przerysowanie zdjęcia-->
<!--            context.clearRect(0, 0, canvas.width, canvas.height);-->
<!--            context.drawImage(photo, 0, 0);-->

<!--            // Rysowanie tekstu na canvas-->
<!--            elements.forEach((element) => {-->
<!--                if (element.type === 'text') {-->
<!--                    context.font = `${element.fontSize}px Arial`;-->
<!--                    context.fillStyle = element.color;-->
<!--                    context.fillText(element.text, element.x, element.y);-->
<!--                }-->
<!--            });-->

<!--            // Przeniesienie naklejek z HTML na canvas-->
<!--            const stickers = document.querySelectorAll('.sticker');-->
<!--            stickers.forEach(sticker => {-->
<!--                const x = parseInt(sticker.style.left, 10) - canvas.offsetLeft;-->
<!--                const y = parseInt(sticker.style.top, 10) - canvas.offsetTop;-->
<!--                context.drawImage(sticker, x, y, sticker.width, sticker.height);-->
<!--            });-->

<!--            // Zapis zdjęcia jako data URL-->
<!--            const editedPhotoData = document.getElementById('edited-photo-data');-->
<!--            editedPhotoData.value = canvas.toDataURL('image/png');-->

<!--            // Wysłanie formularza-->
<!--            event.target.submit();-->
<!--        });-->
<!--    </script>-->
<!--</body>-->
<!--</html>-->
